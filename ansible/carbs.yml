---
- hosts: all
  vars:
    username: thys
  tasks:
    - name: update the system
      become: yes
      pacman:
        update_cache: yes
        upgrade: yes

    - name: Install some common tools
      become: yes
      pacman:
        name:
          - pacman-contrib
          - ansible
          - curl
          - docker
          - git
          - htop
          - lsd
          - rsync
          - stow
          - wget
          - neofetch
          - xclip
        state: present

    - name: Install Python dev env
      become: yes
      pacman:
        name:
          - python
          - python-pip
          - python-virtualenvwrapper
        state: present

    - name: Install code tools
      become: yes
      pacman:
        name:
          - neovim
          - emacs
        state: present

    - name: Install i3 and things it needs
      become: yes
      pacman:
        name:
          - dunst
          - feh
          - acpi 
          - bc 
          - compton
          - conky
          - calcurse
          - i3-gaps
          - i3blocks
          - i3blocks 
          - kitty
          - lightdm 
          - lightdm-gtk-greeter
          - numlockx
          - openvpn
          - rofi
          - sysstat
          - xorg-apps 
          - xorg-server 
          - xorg-xinit 
          - flameshot
        state: present

    - name: Music and Video
      become: yes
      pacman:
        name:
          - mplayer
          - pavucontrol
          - pulsemixer
          - playerctl
          - mpd
          # terminal interface for mpd
          - mpc
          - mpv
          - ncmpcpp
        state: present
          

    - name: Sweet fonts
      become: yes
      pacman:
        name:
          - ttf-joypixels
          - noto-fonts 
          - terminus-font 
          - ttf-dejavu 
          - ttf-droid 
          - ttf-font-awesome
          - ttf-inconsolata 
          - ttf-liberation 
          - ttf-roboto 
          - ttf-ubuntu-font-family 
        state: present

    - name: No annoying beeps please
      become: yes
      copy:
        dest: "/etc/modprobe.d/nobeep.conf"
        content: | 
            # carbs
            # https://wiki.archlinux.org/index.php/PC_speaker 
            blacklist pcspkr

    - name: Touchpad config on XPS 13
      become: yes
      when: ansible_facts['product_name'] == "XPS 13 9350"
      copy:
        dest: "/etc/X11/xorg.conf.d/30-touchpad.conf"
        content: | 
            Section "InputClass"
                Identifier "DLL0704:01 06CB:76AE Touchpad"
                MatchIsTouchpad "on"
                Driver "libinput"
                Option "Tapping" "on"
                Option "Natural Scrolling" "on"
                Option "Accel Speed" "1"
            EndSection
